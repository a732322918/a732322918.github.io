---
layout: default
title: 设计数据源和代理
---

翻译自[Collection View Programming Guide for iOS](https://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/CreatingCellsandViews/CreatingCellsandViews.html#//apple_ref/doc/uid/TP40012334-CH7-SW1)

## 设计你的数据源和代理

每个集合视图必须有一个数据源对象。这个数据源对象是你的应用程序显示的内容。它可以是来自你的应用程序数据模型中的一个对象，或者是管理集合视图的视图控制器。对数据源的唯一要求是它必须提供集合视图需要的信息，像有多少个项目和当显示项目时使用哪个视图。

代理对象是可选的（但是推荐）对象管理与你的内容展示和交互的有关方面。尽管代理的主要工作是管理单元格的高亮和选中，但是它能被扩展提供额外的信息。例如，流布局扩展基本的代理行为来自定义布局矩阵，像单元格的大小及它们之间空间。

### 数据源管理你的内容

数据源对象是管理你使用集合视图要展示的内容的对象。数据源对象必须采用`UICollectionViewDataSource`协议，该协议定义了你必须支持的基本行为和方法。集合视图的工作是为集合视图提供并回答下面的问题：

+ 集合视图包含多少个区段？
+ 对于一个给定的区段，这个区段有多少个项目？
+ 对于一个给定的区段或项目，要使用什么样的视图来展示对应的内容？

对集合视图内容来说，区段和项目是基本的组织原则。一个集合视图通常至少含有一个区段并且可能包含更多。按顺序地，每个区段，包含0个或多个项目。项目展示你想要展示的主要内容，而区段组织它们到逻辑上的分组。例如，一个照片应用程序可能使用区段展示一个单独的相册或在同一天的照片集合。

集合视图使用`NSIndexPath`对象查阅它包含的数据。当尝试定位一个项目，集合使用使用布局对象提供的索引路径信息。对于项目，索引路劲包含区段的编号和项目的编号。对应补充和装饰视图，索引路劲包含了布局对象提供的任何值。附加到补充和装饰视图的索引路径的意义是依赖于你的应用程序，尽管第一个索引对应一个在数据源中的特定的区段。这些视图的索引路径除了含义更多的是关于鉴别，识别什么种类的哪个视图正在被考虑。这样，如果你有补充视图--在流布局中为你的区段创建页眉和页脚，索引路径提供的相关信息是区段引用的。



### 设计你的数据对象

### 告诉集合视图关于你的内容

### 配置单元格和补充视图

### 注册你的单元格和补充视图

### 出列和配置单元格及视图

### 插入、删除和移动区段和项目

### 管理选中和高亮的视觉状态

### 在单元格上显示编辑菜单

### 布局之间转换

